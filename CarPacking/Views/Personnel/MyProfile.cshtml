@model IEnumerable<CarPacking.Models.Personnel>
@using CarPacking.Models
@{
    ApplicationDbContext db = new ApplicationDbContext();
}

<style>
    .main-body {
        padding: 15px;
    }

    .card {
        box-shadow: 0 1px 3px 0 rgba(0,0,0,.6), 0 1px 2px 0 rgba(0,0,0,.06);
        border-radius: .25rem;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .card:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

    .card-body {
        padding: 1rem;
    }

    .gutters-sm {
        margin-right: -8px;
        margin-left: -8px;
    }

        .gutters-sm > .col, .gutters-sm > [class*=col-] {
            padding-right: 8px;
            padding-left: 8px;
        }

    .text-muted {
        color: #6c757d !important;
    }

    .container {
        max-width: 1200px;
    }
</style>

<section class="w3l-index-about py-5" id="about2">
    <div class="container py-md-5 py-2">
        <h2>@ViewBag.Title</h2>
        @{
            var Profile = db.Personnel.Where(x => x.Email == User.Identity.Name).FirstOrDefault();
        }
        @if (Profile == null)
        {
            <p>@Html.ActionLink("Create Profile", "Create", "Personnel")</p>
        }

        @foreach (var item in Model)
        {
            <div class="container">
                <div class="main-body">
                    <div class="row gutters-sm">
                        <div class="col-md-4 mb-3">
                            <div class="card">
                                <div class="card-body text-center">
                                    <img src="~/assets/images/@item.Picture" alt="Profile" class="rounded-circle" width="200" height="170">
                                    <div class="mt-3">
                                        <h4>@item.Name @item.Surname</h4>
                                        <p class="text-secondary mb-1">Personnel</p>
                                        @if (Session["ProductId"] != null)
                                        {
                                            <button class="btn btn-primary" onclick="Assign(@item.PersonnelId, '@item.Name', '@item.Surname')">Assign</button>
                                        }
                                        <button class="btn btn-outline-primary" onclick="location.href='@Url.Action("MyAssignments", "PersonnelAssignments", new { email = item.Email })'">Assignments</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card mb-3">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Full Name</h6>
                                        </div>
                                        <div class="col-sm-9 text-secondary">
                                            @item.Name @item.Surname
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Email</h6>
                                        </div>
                                        <div class="col-sm-9 text-secondary">
                                            @item.Email
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Phone</h6>
                                        </div>
                                        <div class="col-sm-9 text-secondary">
                                            @item.PhoneNumber
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Address</h6>
                                        </div>
                                        <div class="col-sm-9 text-secondary">
                                            @item.Address
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</section>

<script>
    function Assign(id, name, surname) {
        alertify.confirm('Assign Personnel', 'Are you sure you want to assign ' + name + ' ' + surname + ' to this task?', function () {
            window.location.href = '@Url.Action("Create", "PersonnelAssignments")/' + id;
        }, null);
    }
</script>
